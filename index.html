<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfico con CSV</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        /* Tus estilos aquí */
    </style>
</head>
<body>

    <h1>Gráfico de precios de vehículos</h1>
    <label for="category-select">Selecciona la categoría:</label>
    <select id="category-select">
        <option value="Batery">Batería</option>
        <option value="Acceleration">Aceleración</option>
        <option value="TopSpeed">Velocidad Máxima</option>
        <option value="Range">Autonomía</option>
        <option value="Efficiency">Eficiencia</option>
        <option value="NumberofSeats">Número de asientos</option>
    </select>
    
    <canvas id="line-chart" width="400" height="200"></canvas>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const categorySelect = document.getElementById('category-select');

            // Cargar el CSV
            Papa.parse('database.csv', {
                download: true,
                header: true,
                complete: function(results) {
                    // Procesar los datos
                    const data = results.data.map(item => {
                        return {
                            Name: item.Name,
                            Price: parseInt(item.PriceinEurope), // Convertir a número
                            Batery: parseFloat(item.Batery),
                            Acceleration: parseFloat(item.Acceleration),
                            TopSpeed: parseFloat(item.TopSpeed),
                            Range: parseFloat(item.Range),
                            Efficiency: parseFloat(item.Efficiency),
                            NumberofSeats: parseInt(item.NumberofSeats),
                        };
                    });

                    // Actualizar el gráfico inicialmente
                    actualizarGrafico(categorySelect.value, data);

                    // Añadir un listener para cambios en el select
                    categorySelect.addEventListener('change', function() {
                        actualizarGrafico(this.value, data);
                    });
                },
                error: function(err) {
                    console.error('Error al cargar el archivo CSV:', err);
                }
            });

            function actualizarGrafico(categoria, data) {
                const precios = data.map(item => item.Price); // Obtiene los precios
                const valores = data.map(item => item[categoria]); // Obtiene los valores de la categoría seleccionada

                // Crear el gráfico
                const ctx = document.getElementById('line-chart').getContext('2d');
                const chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: precios, // Precios en el eje X
                        datasets: [{
                            label: categoria,
                            data: valores, // Datos de la categoría en el eje Y
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 2,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Precio en Europa'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: categoria
                                }
                            }
                        }
                    }
                });
            }
        });
    </script>

</body>
</html>
